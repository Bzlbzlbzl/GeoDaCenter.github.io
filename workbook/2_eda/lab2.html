<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Luc Anselin" />

<meta name="date" content="2017-10-09" />

<title>Exploratory Data Analysis (EDA)</title>

<link href="lab2_files/highlightjs-1.1/default.css" rel="stylesheet" />
<script src="lab2_files/highlightjs-1.1/highlight.js"></script>
    <title>GeoDa on Github</title>

    <style>
    	*{margin:0;padding:0;}
	.shadowfilter {
	-webkit-filter: drop-shadow(12px 12px 7px rgba(0,0,0,0.5));
	filter: url(shadow.svg#drop-shadow);
	}
	.intro1 { margin-left: -45px;}
    </style>
    <link rel="stylesheet" type="text/css" href="http://geodacenter.github.io/stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="http://geodacenter.github.io/stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="http://geodacenter.github.io/stylesheets/github-light.css" media="screen">
    <link rel="stylesheet" href="../../stylesheets/simple-slideshow-styles.css">
    <style>
    ul {padding-left:30px;} 
	figcaption {
	  top: .70em;
   	  left: .35em;
 	  bottom: auto!important;
	  right: auto!important;
	}
    </style>
    
        <style>
    h1 {
        text-align: center;
    }
    h4.author {
        text-align: center;
    }
    h4.date {
        text-align: center;
    }
    p.caption {
        font-size : 12px;
    }
    </style>
    
<!-- Google Analytics -->
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-72724100-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<!-- End Google Analytics -->
<!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-53RVF8"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-53RVF8');</script>
<!-- End Google Tag Manager -->

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>





</head>

<body>


    <section class="page-header">
      <h1 class="project-name">GeoDa</h1>
      <h2 class="project-tagline">An Introduction to Spatial Data Analysis</h2>
      <a href="http://geodacenter.github.io/download.html" class="btn">Download</a>
      <a href="https://github.com/GeoDaCenter/geoda/" class="btn">View on GitHub</a>
      <a href="https://spatial.uchicago.edu/sample-data"  target="_blank" class="btn">Data</a>
       <a href="http://geodacenter.github.io/documentation.html" class="btn">Documentation</a>
       <a href="http://geodacenter.github.io/support.html" class="btn">Support</a>
       <a href="http://geodacenter.github.io/index-cn.html" class="btn">中文</a>
    </section>


    <section class="main-content">


<h1 class="title toc-ignore">Exploratory Data Analysis (EDA)</h1>
<h4 class="author"><em>Luc Anselin<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a></em></h4>
<h4 class="date"><em>10/09/2017</em></h4>


<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a><ul>
<li><a href="#objectives">Objectives</a><ul>
<li><a href="#geoda-functions-covered">GeoDa functions covered</a></li>
</ul></li>
<li><a href="#getting-started">Getting started</a></li>
</ul></li>
<li><a href="#analyzing-the-distribution-of-a-single-variable">Analyzing the Distribution of a Single Variable</a><ul>
<li><a href="#histogram">Histogram</a><ul>
<li><a href="#linking-a-histogram-and-a-map">Linking a histogram and a map</a></li>
<li><a href="#saving-a-graph-as-an-image">Saving a graph as an image</a></li>
</ul></li>
<li><a href="#box-plot">Box plot</a></li>
</ul></li>
<li><a href="#bivariate-analysis-scatter-plot-and-scatter-plot-matrix">Bivariate Analysis: Scatter Plot and Scatter Plot Matrix</a><ul>
<li><a href="#scatter-plot">Scatter Plot</a><ul>
<li><a href="#scatter-plot-options">Scatter Plot options</a></li>
<li><a href="#lowess-smoother">LOWESS smoother</a></li>
</ul></li>
<li><a href="#brushing-the-scatter-plot-spatial-heterogeneity">Brushing the Scatter Plot – Spatial Heterogeneity</a></li>
<li><a href="#scatter-plot-matrix">Scatter Plot Matrix</a></li>
</ul></li>
<li><a href="#three-variables-bubble-chart-and-3d-scatter-plot">Three Variables: Bubble Chart and 3D Scatter Plot</a><ul>
<li><a href="#bubble-chart">Bubble chart</a></li>
<li><a href="#d-scatter-plot">3D Scatter Plot</a></li>
</ul></li>
<li><a href="#multivariate-eda-parallel-coordinate-plot-and-conditional-plot">Multivariate EDA: Parallel Coordinate Plot and Conditional Plot</a><ul>
<li><a href="#parallel-coordinate-plot-pcp">Parallel Coordinate Plot (PCP)</a></li>
<li><a href="#conditional-plots">Conditional Plots</a></li>
</ul></li>
</ul>
</div>

<p><br></p>
<div id="introduction" class="section level2 unnumbered">
<h2>Introduction</h2>
<p>In this lab, we will explore the EDA functionality in GeoDa, in particular the methods to deal with multiple variables, such as a scatter plot matrix, a parallel coordinate plot and conditional plots. We also illustrate the powerful linking and brushing capability that is central to the architecture of the program. We start with the description and visualization of a single variable, move on to the bivariate scatter plot, and close with a review of multivariate EDA.</p>
<p>This time, will use a data set with demographic and socio-economic information for 55 New York City sub-boroughs. The data are from the <a href="http://coredata.nyc">Furman Institute at NYU</a>. This data set is part of the GeoDa <strong>Sample Data</strong> and can be loaded directly into the program.</p>
<div id="objectives" class="section level3 unnumbered">
<h3>Objectives</h3>
<p>After completing this lab, you should be familiar with the following operations and analyses:</p>
<ul>
<li><p>Descriptive statistics and visualization of the distribution of a single variable (histogram, box plot)</p></li>
<li><p>Scatter plot and scatter plot smoothing (LOWESS)</p></li>
<li><p>Scatter plot brushing and linking</p></li>
<li><p>Assessing spatial heterogeneity through the Chow test</p></li>
<li><p>Interpreting a scatter plot matrix</p></li>
<li><p>Interpreting bubble charts and 3D scatter plots</p></li>
<li><p>Interpreting parallel coordinate plots</p></li>
<li><p>Interpreting conditional plots</p></li>
</ul>
<div id="geoda-functions-covered" class="section level4 unnumbered">
<h4>GeoDa functions covered</h4>
<ul>
<li>Linking and brushing graphs and maps</li>
<li>Variable settings dialog</li>
<li>Explore &gt; Histogram
<ul>
<li>Choose Intervals option</li>
<li>View &gt; Display Statistics option</li>
<li>Save Image as option</li>
</ul></li>
<li>Explore &gt; Box Plot
<ul>
<li>Hinge option</li>
</ul></li>
<li>Explore &gt; Scatter Plot
<ul>
<li>View &gt; Display Precision option</li>
<li>Data option</li>
<li>Smoother option</li>
<li>LOWESS parameters setting</li>
<li>Regimes Regression option and Chow test</li>
</ul></li>
<li>Explore &gt; Scatter Plot Matrix
<ul>
<li>changing the variable order in a scatter plot matrix</li>
<li>smoothing and brushing the scatter plot matrix</li>
</ul></li>
<li>Explore &gt; Bubble Chart
<ul>
<li>bubble chart classification schemes</li>
<li>bubble size</li>
</ul></li>
<li>Explore &gt; 3D Scatter Plot
<ul>
<li>rotating and zooming the 3D scatter plot</li>
<li>projecting onto one axis</li>
<li>selection in the 3D scatter plot</li>
</ul></li>
<li>Explore &gt; Parallel Coordinate Plot
<ul>
<li>changing the classification theme for the PCP</li>
<li>changing the order of the axes</li>
<li>brushing the PCP</li>
</ul></li>
<li>Explore &gt; Conditional Plot
<ul>
<li>conditional scatter plot option</li>
<li>changing the condition breakpoints</li>
<li>LOWESS smoother in conditional plots</li>
</ul></li>
</ul>
<p><br></p>
</div>
</div>
<div id="getting-started" class="section level3 unnumbered">
<h3>Getting started</h3>
<p>We open GeoDa and select (double click on the thumbnail map icon) the data set <strong>NYC Data</strong> from the list contained under the <strong>Sample Data</strong> tab.</p>
<div class="figure" style="text-align: center">
<img src="pics2/0_nyc_sampledata.png" alt="NYC Data sample data set" width="80%" />
<p class="caption">
NYC Data sample data set
</p>
</div>
<p>This opens up a green themeless map of the 55 New York City sub-boroughs.</p>
<div class="figure" style="text-align: center">
<img src="pics2/0_nyc_basemap.png" alt="NYC sub-boroughs" width="60%" />
<p class="caption">
NYC sub-boroughs
</p>
</div>
<p>We will focus our attention on the functionality of the <strong>Explore</strong> menu.</p>
<div class="figure" style="text-align: center">
<img src="pics2/0_explore_menu.png" alt="Explore menu items" width="30%" />
<p class="caption">
Explore menu items
</p>
</div>
<p>The counterpart to the menu items are the collection of eight icons on the main toolbar.</p>
<div class="figure" style="text-align: center">
<img src="pics2/0_explore_icons.png" alt="Explore toolbar icons" width="50%" />
<p class="caption">
Explore toolbar icons
</p>
</div>
<p>The first two icons on the left pertain to univariate analyses, respectively the <strong>Histogram</strong> and <strong>Box Plot</strong>. The <strong>Scatter Plot</strong> extends this to bivariate association, and its generalization, the <strong>Scatter Plot Matrix</strong> consists of a collection of pairwise bivariate associations among multiple variables. A three variable set up is considered in the <strong>Bubble Chart</strong> and <strong>3D Scatter Plot</strong>, and full multivariate associations are explored in the <strong>Parallel Coordinate Plot</strong> and the <strong>Conditional Plots</strong>. We now consider each in turn, starting with the univariate approaches.</p>
</div>
</div>
<div id="analyzing-the-distribution-of-a-single-variable" class="section level2 unnumbered">
<h2>Analyzing the Distribution of a Single Variable</h2>
<div id="histogram" class="section level3 unnumbered">
<h3>Histogram</h3>
<p>We begin our analysis with the simple description of the distribution of a single variable. Arguably the most familiar statistical graphic is the histogram, which is a discrete representation of the density function of a variable. In essence, the range of the variable (the difference between maximum and minimum) is divided into a number of equal intervals (or bins), and the number of observations that fall within each bin is depicted in a bar graph.</p>
<p>The histogram functionality is started by selecting <strong>Explore &gt; Histogram</strong> from the menu, or by clicking on the <strong>Histogram</strong> toolbar icon, the left-most icon in the set.</p>
<div class="figure" style="text-align: center">
<img src="pics2/1_histogram_icon.png" alt="Histogram toolbar icon" width="50%" />
<p class="caption">
Histogram toolbar icon
</p>
</div>
<p>This brings up the <strong>Variable Settings</strong> dialog, which lists all the numeric variables in the data set (string variables cannot be analyzed). Scroll down until you can select <strong>kids2009</strong>, the percentage of households with kids under age 18 in 2009.</p>
<div class="figure" style="text-align: center">
<img src="pics2/1_hist_variable.png" alt="Histogram variable selection" width="20%" />
<p class="caption">
Histogram variable selection
</p>
</div>
<p>After clicking <strong>OK</strong>, the default histogram appears, showing the distribution of the 55 observations over seven bins. The distribution tends to be skewed to the left, with a tail on the low end and most taller bins on the high end, suggesting more areas with a higher percentage of kids under 18.</p>
<div class="figure" style="text-align: center">
<img src="pics2/1_default_histogram.png" alt="Default histogram" width="50%" />
<p class="caption">
Default histogram
</p>
</div>
<p>There are two important options for the histogram. One is to set the number of intervals for the default equal interval setting, the other to customize the values of the cut-off points completely. We will postpone a consideration of the latter until the discussion of choropleth maps (in essence, a map version of a histogram).</p>
<p>The options are brought up in the usual fashion, by right clicking on the graph.</p>
<div class="figure" style="text-align: center">
<img src="pics2/1_hist_chooseint.png" alt="Choose intervals histogram option" width="30%" />
<p class="caption">
Choose intervals histogram option
</p>
</div>
<p>After selecting the <strong>Choose Intervals</strong> option, a dialog appears that lets you set the number of intervals explicitly. The default is 7, but in our example, we change this to 5.</p>
<div class="figure" style="text-align: center">
<img src="pics2/1_interval5.png" alt="Histogram intervals set to 5" width="30%" />
<p class="caption">
Histogram intervals set to 5
</p>
</div>
<p>The resulting histogram now has five bars.</p>
<div class="figure" style="text-align: center">
<img src="pics2/1_hist_5cats.png" alt="Histogram with 5 intervals" width="50%" />
<p class="caption">
Histogram with 5 intervals
</p>
</div>
<p>Note how the wider bins for the histogram somewhat smooth the shape of the distribution.</p>
<p>A second important option for the histogram (and any other statistical graph) is to display descriptive statistics in the graph. This is accomplished by selecting <strong>View &gt; Display Statistics</strong> in the option menu.</p>
<div class="figure" style="text-align: center">
<img src="pics2/1_display_stats.png" alt="Display statistics option" width="50%" />
<p class="caption">
Display statistics option
</p>
</div>
<p>The <strong>Display Statistics</strong> option adds a number of descriptors below the graph. The summary statistics are given at the bottom. We see that the 55 observations have a minimum value of 0, a maximum of 48.1, median of 33.5, mean of 32.1 and a standard deviation of 10.4. We take the minimum value as is, even though a percentage of zero may seem suspicious. In addition, for the histogram, descriptive statistics are provided for each interval, showing the range for the interval, the number of observations as a count and as a percentage of the total number of observations, and the number of standard deviations away from the mean for the center of the bin. This allows us to identify potential outliers, e.g., as defined by those observations more than two standard deviations from the mean. In our example, the lowest category would satisfy this criterion.</p>
<p>In addition to the summary characteristics for each bin listed at the bottom, the summary of each bin appears in the status bar when the cursor is moved over that bin. This works whether the descriptive statistics option is on or not. In our example, the cursor is over the central bin.</p>
<div class="figure" style="text-align: center">
<img src="pics2/1_histwstats.png" alt="Histogram with descriptive statistics" width="70%" />
<p class="caption">
Histogram with descriptive statistics
</p>
</div>
<p>Other options available in the Histogram are adjustments to various color settings (<strong>Color</strong>), saving the selection (see below), <strong>Copy the Image to Clipboard</strong> and saving the graph as an image file (see below).</p>
<div id="linking-a-histogram-and-a-map" class="section level4 unnumbered">
<h4>Linking a histogram and a map</h4>
<p>To illustrate the concept of <em>linked</em> graphs and maps, we first set the number of intervals for the histogram back to 7 (<strong>Choose Intervals &gt; 7</strong>). Then we select the three left-most bars in the histogram (click and command-click to expand the selection). The highlighted bars keep their color, whereas the non-selected ones become transparent. This is the standard approach to visualize a selection in a graph in GeoDa.<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a></p>
<p>Immediately upon selection in the graph, the corresponding observations in the map are also highlighted. In our current example, the map is a simple themeless map (all areal units are green), but in more realistic applications, the map can be any type of choropleth map, for the same variable or for a different variable. The latter can be very useful in the exploration of categorical overlap between variables.</p>
<p>In our example, the histogram bars at the low end of the distributions (i.e., with a low percentage of households with kids) correspond to sub-boroughs primarily located in Manhattan, which should not come as a surprise.</p>
<div class="figure" style="text-align: center">
<img src="pics2/1_150_linkhistmap.png" alt="Linking a histogram and a map" width="100%" />
<p class="caption">
Linking a histogram and a map
</p>
</div>
<p>The reverse linking works as well. For example, using a rectangular selection tool on the themeless map, we can select sub-boroughs in Manhattan and adjoining Brooklyn. The linked histogram will show the attribute distribution for the selected spatial units as highlighted fractions of the bars (the transparent bars correspond to the unselected areal units).</p>
<div class="figure" style="text-align: center">
<img src="pics2/1_151_linkmaphist.png" alt="Linking a map and a histogram" width="100%" />
<p class="caption">
Linking a map and a histogram
</p>
</div>
<p>As we have seen before, it is also possible to save the selection in the form of a 0-1 indicator variable with the <strong>Save Selection</strong> option.</p>
<p>The technique of linking, and its dynamic counterpart of <em>brushing</em> (more later) is central to the data exploration philosophy that is behind GeoDa.</p>
</div>
<div id="saving-a-graph-as-an-image" class="section level4 unnumbered">
<h4>Saving a graph as an image</h4>
<p>A useful option associated with any graph in GeoDa is the possibility to save the graph as an image, in either <strong>png</strong> (the default) or <strong>bmp</strong> format. This process is started by selecting <strong>Save Image As</strong> from the options menu (right click on the graph).</p>
<div class="figure" style="text-align: center">
<img src="pics2/1_saveimageas.png" alt="Save image as option" width="25%" />
<p class="caption">
Save image as option
</p>
</div>
<p>The resulting file dialog provides a way to specify a file name and a location where to save the file. The default file name in our example is <strong>NYC DataHistogramFrame.png</strong>. For the histogram without descriptive statistics, with 7 categories and selections highlighted, the corresponding figure is as shown below. This makes it easy to incorporate the graphs in a document.</p>
<div class="figure" style="text-align: center">
<img src="pics2/NYC%20DataHistogramFrame.png" alt="Histogram as png image" width="60%" />
<p class="caption">
Histogram as png image
</p>
</div>
</div>
</div>
<div id="box-plot" class="section level3 unnumbered">
<h3>Box plot</h3>
<p>A box plot is an alternative visualization of the distribution of a single variable. It is invoked as <strong>Explore &gt; Box Plot</strong>, or by selecting the <strong>Box Plot</strong> icon in the toolbar.</p>
<div class="figure" style="text-align: center">
<img src="pics2/2_154_boxploticon.png" alt="Box plot toolbar icon" width="50%" />
<p class="caption">
Box plot toolbar icon
</p>
</div>
<p>As for the histogram, this is followed by a <strong>Variable Settings</strong> dialog to select the variable. In GeoDa, the default is that the variable from any previous analysis is already selected. In our example, we continue with <strong>kids2009</strong>. This brings up the box plot graph.</p>
<div class="figure" style="text-align: center">
<img src="pics2/2_155_boxplot.png" alt="Default box plot" width="40%" />
<p class="caption">
Default box plot
</p>
</div>
<p>The box plot focuses on the quantiles of the distribution. The data points are sorted from small to large. The median (50 percent point) is represented by the horizontal orange bar in the middle of the distribution. The brown rectangle goes from the first quartile (25th percentile) to the third quartile (75th percentile). The difference between the values that correspond to the third (39.7) and the first (26.7) is referred to as the inter-quartile range (IQR). The interquartile range is a measure of the spread of the distribution, a non-parametric counterpart to the standard deviation. In our example, the IQR is 13.0. The horizontal lines drawn at the top and bottom of the graph are the so-called <em>fences</em> or <em>hinges</em>. They correspond to the values of the first quartile less 1.5 IQR (i.e., 26.7 - 1.5x13 = 7.2), and the third quartile plus 1.5 IQR (i.e., 39.7 + 1.5x13 = 59.2). Observations that fall outside the fences are considered to be <em>outliers</em>. In our example, we have a single lower outlier, but no upper outliers. Note that the one lower outlier is the observations that corresponds with a value of 0 (the minimum), which we earlier had flagged as potentially suspicious. The outlier detection would seem to confirm this. Checking for <em>strange</em> values that may possibly be coding errors or suggest other measurement problems is one of the very useful applications of a box plot.</p>
<p>The default in GeoDa is to list the summary statistics at the bottom of the box plot. As for the histogram, these include the minumum, maximum, mean, median and standard deviation. In addition, the values for the first and third quartile and the resulting IQR are given as well. The listing of descriptive statistics can be turned off by unchecking <strong>View &gt; Display Statistics</strong> (i.e., the reverse of what held for the histogram).</p>
<p>The typical multiplier for the IQR to determine outliers is 1.5 (roughly equivalent to the practice of using two standard deviations in a parametric setting). However, a value of 3.0 is fairly common as well, which considers only truly outlying observations as outliers. The multiplier to determine the fence can be changed with the <strong>Hinge &gt; 3.0</strong> option (right click in the plot to select).</p>
<div class="figure" style="text-align: center">
<img src="pics2/2_156_changehinge.png" alt="Change the box plot hinge" width="30%" />
<p class="caption">
Change the box plot hinge
</p>
</div>
<p>The resulting box plot (with the statistics display turned off below) no longer shows the lower outlier.</p>
<div class="figure" style="text-align: center">
<img src="pics2/2_157_boxplot3.png" alt="Box plot with hinge = 3.0" width="40%" />
<p class="caption">
Box plot with hinge = 3.0
</p>
</div>
<p>Several other options for the box plot are the same as for the histogram, such as saving the selection, copying the image to the clipboard, and saving the graph as an image file.</p>
<p>Also, as for any other graph in GeoDa, linking is implemented. For example, selecting the lower outlier in the box plot will highlight the corresponding obbservation in the themeless map of sub-boroughs. As illustrated for the histogram, the reverse process (selecting in the map) works as well.</p>
<div class="figure" style="text-align: center">
<img src="pics2/2_158_linkboxmap.png" alt="Showing the outlier on a linked map" width="100%" />
<p class="caption">
Showing the outlier on a linked map
</p>
</div>
<p>The main purpose of the box plot in an exploratory strategy is to identify outlier observations. Later, we will see how to assess whether such outliers also coincide in space.</p>
</div>
</div>
<div id="bivariate-analysis-scatter-plot-and-scatter-plot-matrix" class="section level2 unnumbered">
<h2>Bivariate Analysis: Scatter Plot and Scatter Plot Matrix</h2>
<div id="scatter-plot" class="section level3 unnumbered">
<h3>Scatter Plot</h3>
<p>The standard tool to assess a <em>linear</em> relationship between two variables is the scatter plot, a diagram with two axes, each corresponding to one of the variables. The observation (x, y) pairs are plotted as points in the diagram.</p>
<p>We create a scatter plot by clicking on its toolbar icon, or by selecting <strong>Explore &gt; Scatter Plot</strong> from the menu. The <strong>Scatter Plot</strong> icon is the third in the EDA group on the toolbar.</p>
<div class="figure" style="text-align: center">
<img src="pics2/3_scatterplot_icon.png" alt="Scatter Plot toolbar icon" width="50%" />
<p class="caption">
Scatter Plot toolbar icon
</p>
</div>
<p>This brings up the <strong>Scatter Plot Variables</strong> dialog where the variables for the X and Y axes are selected. In our example, we will choose the percentage of households with kids under age 18 in 2000 (<strong>kids2000</strong>) as the X-variable and the percentage of households receiving public assistance (<strong>pubast00</strong>) as the Y-variable.</p>
<div class="figure" style="text-align: center">
<img src="pics2/3_scatterplot_variables.png" alt="Scatter Plot variable selection" width="50%" />
<p class="caption">
Scatter Plot variable selection
</p>
</div>
<p>Clicking <strong>OK</strong> brings up the scatter plot. The default view of the scatter plot is to use the variables in their original scales (i.e., not standardized), show the axis through zero (as a dashed line), and fit a linear smoother (i.e., a least squares regression fit). At the bottom of the graph, some summary statistics are listed for the regression line, such as the R<sup>2</sup> fit, and the estimate, standard error, t-statistic and p-value for both the intercept and the slope coefficient.</p>
<div class="figure" style="text-align: center">
<img src="pics2/3_default_scatter_plot.png" alt="Default Scatter Plot" width="80%" />
<p class="caption">
Default Scatter Plot
</p>
</div>
<p>In the current setup, no observations are selected, so that the second line in the statistical summary (all red zeros) has no values. This line pertains to the selected observations. The blue line at the bottom relates to the unselected observation. The sum of the number of observations in each of the two subsets always equals the total number of observations, listed on the top line.</p>
<div id="scatter-plot-options" class="section level4 unnumbered">
<h4>Scatter Plot options</h4>
<p>The scatter plot has several interesting options. As usual, these are brought up by right clicking in the view or by selecting <strong>Options</strong> in the menu.</p>
<div class="figure" style="text-align: center">
<img src="pics2/5_175_scatplotoptions.png" alt="Scatter Plot options" width="50%" />
<p class="caption">
Scatter Plot options
</p>
</div>
<p>Several of the options should by now be familiar, such as the <strong>Selection Shape</strong>, <strong>Color</strong>, <strong>Save Selection</strong> and the two ways to save the image. The <strong>Data</strong> item provides a choice between the variables on their original scale (the default) and the use of standardized variables. Note that when you use the standardized form, the slope of the linear smoother is also the correlation coefficient between the two variables.</p>
<p>The <strong>View</strong> option shows the default settings with the <strong>Statistics</strong> displayed below the graph, the <strong>Axes Through Origin</strong> shown as dashed lines, and the <strong>Status Bar</strong> active. Two other default settings are to have a <strong>Fixed Aspect Ratio</strong> and <strong>Regimes Regression</strong> active. The latter will result in three different linear smoothers to be computed when observations are selected. We revisit this when we consider brushing the scatter plot.</p>
<p>The first view option is not set by default. It controls the precision by which the values are displayed on the axes. In our scatter plot, this is currently two digits. When checking <strong>Set Display Precision on Axes</strong> a dialog pops up. For example, we can turn the precision to 1 digit.</p>
<div class="figure" style="text-align: center">
<img src="pics2/5_177_axesdisplay.png" alt="Display precision for scatter plot axes" width="30%" />
<p class="caption">
Display precision for scatter plot axes
</p>
</div>
<p>The values displayed on the axes are adjusted in accordance with the new precision setting.</p>
<div class="figure" style="text-align: center">
<img src="pics2/5_178_axesw1.png" alt="Scatter Plot with different precision" width="60%" />
<p class="caption">
Scatter Plot with different precision
</p>
</div>
</div>
<div id="lowess-smoother" class="section level4 unnumbered">
<h4>LOWESS smoother</h4>
<p>We turn the precision back to 2 digits and explore a non-linear smoother of the scatter plot. A LOWESS nonlinear local regression fit reveals potential nonlinearities in the bivariate relationship and may suggest the presence of structural breaks. It is selected in the <strong>Smoother</strong> option.</p>
<div class="figure" style="text-align: center">
<img src="pics2/4_scatter_smoother_options.png" alt="Scatter Plot smoothing options" width="40%" />
<p class="caption">
Scatter Plot smoothing options
</p>
</div>
<p>The <strong>Show LOWESS Smoother</strong> option adds the nonlinear fit to the scatter plot. Note that by default the <strong>Show Linear Smoother</strong> option remains checked, so that this needs to be unchecked to see only the nonlinear fit. Below, we compare both options. Having both options selected facilitates a comparison of the two fits.</p>
<div class="figure" style="text-align: center">
<img src="pics2/4_164_defaultlowess.png" alt="Default LOWESS smoother" width="60%" />
<p class="caption">
Default LOWESS smoother
</p>
</div>
<div class="figure" style="text-align: center">
<img src="pics2/4_167_loweswolinear.png" alt="LOWESS smoother without linear fit" width="60%" />
<p class="caption">
LOWESS smoother without linear fit
</p>
</div>
<p>In our example, there is considerable evidence of a nonlinear relationship between the two variables. An alternative interpretation is to see this as an indication of structural breaks, where in one subset of the data the slope is very steep, whereas in another it is fairly flat.</p>
<p>The nonlinear fit is driven by a number of parameters, the most important of which is the bandwidth. The parameters can be changed in the options by selecting <strong>Edit LOWESS Parameters</strong> in the <strong>Smoother</strong> option. A small dialog is brought up in which the <strong>Bandwidth</strong> (default setting 0.20), <strong>Iterations</strong> and <strong>Delta Factor</strong> can be adjusted. The bandwidth determines the smoothness of the curve and is given as a fraction of the total range in X values. In other words, the default bandwidth of 0.20 implies that for each local fit (centered on a value for X), about one fifth of the scatter points are taken into account. In the example below, we changed this to 0.40, which results in a much smoother curve that brings out a possible structural break in the data in a more striking fashion.</p>
<div class="figure" style="text-align: center">
<img src="pics2/4_lowess040.png" alt="LOWESS bandwidth settings" width="30%" />
<p class="caption">
LOWESS bandwidth settings
</p>
</div>
<div class="figure" style="text-align: center">
<img src="pics2/4_165_lowess040.png" alt="LOWESS smoother bandwidth 0.40" width="60%" />
<p class="caption">
LOWESS smoother bandwidth 0.40
</p>
</div>
<p>The plot seems to suggest that the linear fit is really a compromise between two slopes. There is a steep slope for observations with a value for households with children above 40 percent, suggesting a major increase in public assistance with every increase in the percentage children. With values for <strong>kids2000</strong> below 40, the slope is much gentler and even flat in small subsets of the data.</p>
<p>The opposite effect is obtained when the bandwidth is made smaller. For example, with a value of 0.10, the resulting curve is much more jagged and less informative.</p>
<div class="figure" style="text-align: center">
<img src="pics2/4_166_lowess010.png" alt="LOWESS smoother bandwidth 0.10" width="60%" />
<p class="caption">
LOWESS smoother bandwidth 0.10
</p>
</div>
<p>The literature contains many discussions of the notion of an optimal bandwidth, but in practice a trial and error approach is often more effective. In any case, a value for the bandwidth that follows one of these rules of thumb can be entered in the dialog. Currently, GeoDa does not compute these for you.</p>
</div>
</div>
<div id="brushing-the-scatter-plot-spatial-heterogeneity" class="section level3 unnumbered">
<h3>Brushing the Scatter Plot – Spatial Heterogeneity</h3>
<p><em>Linking</em> and <em>brushing</em> are powerful techniques to assess structural breaks in the data, such as evidence of spatial heterogeneity. We have already seen how a selection in any of the views results in the same observation to immediately be selected in all other views through linking. Brushing is a dynamic extension of this process. This is the most insightful when applied to the combination of a map and a scatter plot, but it equally applies to all the other views.</p>
<p>The brushing process is initiated by setting up a selection shape in one of the views. The default is a rectangular shape, but we have seen earlier how that can be changed to a circle or a line. In our example, we keep the default. Click anywhere in the scatter plot and draw the pointer into a rectangular shape, as shown below. Note how the pointer is attached to a corner of the rectangle. At this point, the shape can be moved around in the view, dynamically changing the selection. In our example, we have selected 22 observations. The purple line represents the original linear fit, the red line is the fit for the 22 selected observations, and the blue line is the fit for the other 33 observations. Below the three lines with the slope coefficients and fit statistics, the results of a Chow test on structural stability are listed. Clearly, in contrast to the overall purple and the blue line, there is no relationship at all for the selected observations in question, as evidenced by the horizontal red line. The Chow test confirms this by strongly rejecting (p &lt; 0.0005) the null hypothesis of equal coefficients (between the blue and the red lines).</p>
<div class="figure" style="text-align: center">
<img src="pics2/6_179_brush_scat1.png" alt="Brushing the scatter plot -- 1" width="60%" />
<p class="caption">
Brushing the scatter plot – 1
</p>
</div>
<p>Because of the linking, the 22 selected observations are also highlighted in all the other views, such as the green themeless map shown below. In an actual application, this map can be for a third variable, allowing us to investigate potential interaction effects.</p>
<div class="figure" style="text-align: center">
<img src="pics2/6_180_map1.png" alt="Linked map selection -- 1" width="60%" />
<p class="caption">
Linked map selection – 1
</p>
</div>
<p>With the <strong>Regimes Regression</strong> option turned on, the three linear fits change instantaneously as different observations are selected. Of course, the fits themselves are only meaningful when sufficient observations are part of the selection. For example, we can move the selection rectangle up and to the right, which yields a new selection of 10 observations, with associated regression lines. This time, there is insufficient evidence to reject the null hypothesis (Chow test with p = 0.975).</p>
<div class="figure" style="text-align: center">
<img src="pics2/6_181_brush_scat2.png" alt="Brushing the scatter plot -- 2" width="60%" />
<p class="caption">
Brushing the scatter plot – 2
</p>
</div>
<p>Again, the matching locations are shown in the map. As the selection rectangle moves in the scatter plot, the highlighted sub-boroughs in the map change as well.</p>
<div class="figure" style="text-align: center">
<img src="pics2/6_182_map2.png" alt="Linked map selection -- 2" width="60%" />
<p class="caption">
Linked map selection – 2
</p>
</div>
<p>The process can also be reversed and started in a view other than the scatter plot. For example, we can brush the map (in our example, 10 observations are selected), and assess how the linear fits are affected in the scatter plot.</p>
<div class="figure" style="text-align: center">
<img src="pics2/6_183._brushmap1.png" alt="Brushing the map -- 1" width="60%" />
<p class="caption">
Brushing the map – 1
</p>
</div>
<div class="figure" style="text-align: center">
<img src="pics2/6_184_scat1.png" alt="Linked scatter plot selection -- 1" width="60%" />
<p class="caption">
Linked scatter plot selection – 1
</p>
</div>
<p>The map selection results in a rejection of the null hypothesis of constant slopes with p &lt; 0.003. In other words, the slope in the region we selected in the map is significantly different from the slope in the rest of the map, suggesting spatial heterogeneity.</p>
<p>As we brush across the map, we can assess the degree to which the linear relationship is stable. Any systematically changing slopes between clearly defined sub-regions of the observations would suggest the presence of spatial heterogeneity. For example, moving the selection rectangle north makes the evidence for stuctural change somewhat weaker (Chow test with p &lt; 0.01).</p>
<div class="figure" style="text-align: center">
<img src="pics2/6_185_brushmap2.png" alt="Brushing the map -- 2" width="60%" />
<p class="caption">
Brushing the map – 2
</p>
</div>
<div class="figure" style="text-align: center">
<img src="pics2/6_186_scat2.png" alt="Linked scatter plot selection -- 2" width="60%" />
<p class="caption">
Linked scatter plot selection – 2
</p>
</div>
<p>As we identify subregions in the data with a different slope (structure) from the rest, we can assess this more formally through regression analysis (e.g., analysis of variance). This is facilitated by <strong>Saving</strong> the selection in the form of an indicator variable (with 1 for the selected observations) that can then be incorporated in a regression specification.</p>
</div>
<div id="scatter-plot-matrix" class="section level3 unnumbered">
<h3>Scatter Plot Matrix</h3>
<p>A scatter plot matrix visualizes the bivariate relationships among several variables. The individual scatter plots are stacked such that each variable is in turn a dependent variable and an explanatory variable. In a sense, it is the visual counterpart of a correlation matrix. In GeoDa, the diagonal elements contain a histogram for the variable in the corresponding row/column.</p>
<p>You start the scatter plot matrix by selecting the corresponding icon on the toolbar (part of the EDA icons) or by choosing <strong>Explore &gt; Scatter Plot Matrix</strong> from the menu.</p>
<div class="figure" style="text-align: center">
<img src="pics2/7_scatmatrix_icon.png" alt="Scatter Plot Matrix toolbar icon" width="50%" />
<p class="caption">
Scatter Plot Matrix toolbar icon
</p>
</div>
<p>This brings up a dialog through which variables can be added or removed. Select a variable from the list on the left and click on the right arrow <strong>&gt;</strong> to include it in the list on the right. The left arrow <strong>&lt;</strong> removes a variable from the <strong>Include</strong> list.</p>
<div class="figure" style="text-align: center">
<img src="pics2/7_187_scatplotmatvars.png" alt="Scatter Plot Matrix variables selection" width="50%" />
<p class="caption">
Scatter Plot Matrix variables selection
</p>
</div>
<p>As soon as two variables are selected, the scatter plot matrix is rendered in the background. As we continue to add variables to the list on the right, the matrix in the background is updated with the additional scatter plots. In our example, we selected average people per household in 2000 (<strong>hhsiz00</strong>), the percentage households with children under 18 in 2000 (<strong>kids2000</strong>), the average number of years lived in the current residence in 2002 (<strong>yrhom02</strong>) and the percentage households receiving public assistance in 2000 (<strong>pubast00</strong>). The order of the variables can be changed by means of the <strong>Up</strong> and <strong>Down</strong> buttons in the dialog.</p>
<div class="figure" style="text-align: center">
<img src="pics2/7_188_scatplotmat_vars.png" alt="Scatter Plot Matrix variables" width="50%" />
<p class="caption">
Scatter Plot Matrix variables
</p>
</div>
<p>Once we move the dialog aside, the full 4 x 4 scatter plot matrix is revealed.</p>
<div class="figure" style="text-align: center">
<img src="pics2/7_189_scatplotmat.png" alt="Scatter Plot Matrix" width="80%" />
<p class="caption">
Scatter Plot Matrix
</p>
</div>
<p>The graph shows both positive and negative associations, as well as non-significant ones. The slope of the linear fit is listed above each scatter plot, with significance indicated by one * (p &lt; 0.05) or two ** (p &lt; 0.01). The histograms in the diagonal provide a sense of the shape of the distribution for each variable. Among others, the graph reveals a strongly significant and positive relationship between the percentage households with kids and public assistance (as we saw before in the scatter plot), and a strong negative and significant relationship between number of years in the residence and public assistance. The relationship between years in residence and percent households with kids is not significant.</p>
<p>As is customary, a right click (or control click) brings up the options. The defaults are the linear fit, with linking and brushing enabled (<strong>Regimes Regression</strong>) and the slope values displayed. Selecting <strong>Add/Remove Variables</strong> bring back the variable selection dialog. In addition to the linear fit, the scatter plot matrix also supports a LOWESS fit, with the same parameter editing capability as in the standard scatter plot.</p>
<div class="figure" style="text-align: center">
<img src="pics2/7_190_smoother.png" alt="Scatter Plot Matrix smoothing options" width="50%" />
<p class="caption">
Scatter Plot Matrix smoothing options
</p>
</div>
<p>A LOWESS smoother (with bandwidth 0.40) reveals considerable non-linearity in some of the bivariate relationships.</p>
<div class="figure" style="text-align: center">
<img src="pics2/7_191_scatplotmat_smooth.png" alt="Scatter Plot Matrix with smoothing" width="80%" />
<p class="caption">
Scatter Plot Matrix with smoothing
</p>
</div>
<p>Finally, with the brushing and linking functionality enabled, potential structural breaks can be further investigated dynamically. As in the standard scatter plot, the red linear fit corresponds to the selected observations, the blue line is for the unselected ones and the purple line is for the complete sample. The selected observations are also highlighted in the histograms on the diagonal, as well as in any other open windows/graphs.</p>
<div class="figure" style="text-align: center">
<img src="pics2/7_192_scatmat_brush.png" alt="Scatter Plot Matrix with brushing" width="80%" />
<p class="caption">
Scatter Plot Matrix with brushing
</p>
</div>
</div>
</div>
<div id="three-variables-bubble-chart-and-3d-scatter-plot" class="section level2 unnumbered">
<h2>Three Variables: Bubble Chart and 3D Scatter Plot</h2>
<p>Once we move beyond two variables, it becomes difficult to visualize the relationships among the variables in higher-dimensional space explictly. Techniques to deal with such higher dimensions all boil down to reducing the dimensionality of the problem, i.e., attempting to show the relationships in a two-dimensional plane. In this section, we consider two of these techniques that work for situations in three dimensions (or, at most, four).</p>
<div id="bubble-chart" class="section level3 unnumbered">
<h3>Bubble chart</h3>
<p>The bubble chart is an extension of the scatter plot to include a third and possibly a fourth variable into the two-dimensional chart. While the points in the two-dimensional scatter plot remain as showing the association between two variables, the size of the points (the <em>bubble</em>) is used to introduce a third variable. In addition, the color shading of the points can be used to consider a fourth variable as well, although this may stretch our perceptual abilities.</p>
<p>The bubble chart is invoked from the menu as <strong>Explore &gt; Bubble Chart</strong> and from the toolbar by selecting the fifth icon.</p>
<div class="figure" style="text-align: center">
<img src="pics2/8_193_bubbleicon.png" alt="Bubble Chart toolbar icon" width="50%" />
<p class="caption">
Bubble Chart toolbar icon
</p>
</div>
<p>This brings up a dialog to select the variables for up to four dimensions: x-axis, y-axis, bubble size and bubble color. In our example, we take <strong>kids2000</strong> (percentage households with children under 18), <strong>pubast00</strong> (percentage households receiving public assistance), and <strong>rent2002</strong> (median rent) as the three variables. We take the color for the <em>bubble</em> to be the same as the bubble size (<strong>rent2002</strong>).</p>
<div class="figure" style="text-align: center">
<img src="pics2/8_194_bubblevars.png" alt="Bubble Chart variable selection" width="80%" />
<p class="caption">
Bubble Chart variable selection
</p>
</div>
<p>The resulting graph shows the same scatter plot as before, but now with the size and color of the circle reflecting the magnitude of the rent (red is high, blue is low). We see that the higher rents (larger bubbles) are situated in the lower left corner of the scatter plot. This suggests an interaction between the three variables, e.g., the higher median rent tends to be in sub-boroughs with a small percentage of households with children or receiving public assistance. This interaction between the three variables is not something we might have expected a priori (or, maybe it is, but the graphs brings it out more explicitly). The null case would be that there is no structural relationship between the two original variables and the third, resulting in a graph with the size/color of the bubbles randomly distributed throughout.</p>
<div class="figure" style="text-align: center">
<img src="pics2/8_196_bubbchart.png" alt="Bubble Chart" width="80%" />
<p class="caption">
Bubble Chart
</p>
</div>
<p>In addition to the usual features we have seen before, the bubble chart has a few unique features in the options menu. The first item allows one to choose the <strong>Classification Theme</strong>. The default is the <strong>Standard Deviation</strong> theme, where the colors correspond to standard deviational units away from the mean (red colors above the mean, blue colors below the mean). We will revisit the different classification schemes when we discuss the <strong>Map</strong> functionality in GeoDa.</p>
<div class="figure" style="text-align: center">
<img src="pics2/8_197_classthemes.png" alt="Bubble Chart theme selection" width="40%" />
<p class="caption">
Bubble Chart theme selection
</p>
</div>
<p>Another option specific to the bubble chart is to set the size of the bubble, with <strong>Adjust Bubble Size</strong> (the bottom item in the menu). This brings up a dialog with a slider to change the size of the circles. This is particularly useful when the default size overwhelms the graph.</p>
<div class="figure" style="text-align: center">
<img src="pics2/8_198_bubbsize.png" alt="Bubble Chart size adjustment" width="80%" />
<p class="caption">
Bubble Chart size adjustment
</p>
</div>
<p>Given the screen real estate taken up by the circles in the bubble chart, this is a technique that lends itself particularly well for small to medium sized data sets. For large size data sets, this particular graph is less appropriate.</p>
</div>
<div id="d-scatter-plot" class="section level3 unnumbered">
<h3>3D Scatter Plot</h3>
<p>An explicit visualization of the relationship between three variables is possible in a three-dimensional scatter plot, a direct extension of the principles used in two dimensions to a three-dimensional data cube. Each of the dimensions of the cube corresponds to a variable, and the observations are shown as a point cloud in three dimensions (of course, projected onto the two-dimensional plane of our screen).</p>
<p>This device is invoked as <strong>Explore &gt; 3D Scatter Plot</strong> from the menu, or by selecting the corresponding icon on the toolbar (the third from the right in the EDA group).</p>
<div class="figure" style="text-align: center">
<img src="pics2/9_203_3dscaticon.png" alt="3D Scatter Plot toolbar icon" width="50%" />
<p class="caption">
3D Scatter Plot toolbar icon
</p>
</div>
<p>The choice of this icon brings up a variable selection dialog for the variables corresponding to the <strong>X</strong>, <strong>Y</strong> and <strong>Z</strong> dimensions. We stay with the same variables as before: <strong>kids2000</strong>, <strong>pubast00</strong>, and <strong>rent2002</strong>.</p>
<div class="figure" style="text-align: center">
<img src="pics2/9_204_3dscat_vars.png" alt="3D Scatter Plot variable selection" width="60%" />
<p class="caption">
3D Scatter Plot variable selection
</p>
</div>
<p>The default 3D scatter plot shows the data cube with the y-axis as vertical, and the z and x-axes as horizontal.</p>
<div class="figure" style="text-align: center">
<img src="pics2/9_205_3dscatplot1.png" alt="3D Scatter Plot" width="80%" />
<p class="caption">
3D Scatter Plot
</p>
</div>
<p>The data cube can be re-sized (by pressing the control key) and moved around by means of the pointer. In addition, the controls on the left-hand side of the view allow for the projection of the point cloud onto a given two-dimensional pane, and the construction of a selection box. For example, with the cube zoomed in and the axes rotated such that Z is now vertical, checking the <strong>Project to X-Y</strong> box adds a 2-dimensional scatter plot onto the X-Y plane.</p>
<div class="figure" style="text-align: center">
<img src="pics2/9_206_zoomandprojext.png" alt="3D Scatter Plot zoom and project" width="80%" />
<p class="caption">
3D Scatter Plot zoom and project
</p>
</div>
<p>Selection in the three dimensional plot (or, rather, its two-dimensional projection) is a little tricky and takes some practice. The selection can be done either manually, by pressing down the command key while moving the pointer, or by using the guides under the selection check box.</p>
<p>Checking the box next to <strong>Select</strong> creates a small red selection cube in the graph. This can be moved around with the command key pressed, or can be moved and resized by using the controls. The first set of controls (to the left) move the box along the matching dimension, e.g., up or down the X values for larger or smaller values of the percentage households with kids, and the same for the other two variables. The control to the right changes the size of the box in the corresponding dimension (e.g., larger along the x dimension). The combination of these controls moves the box around to select observation points, with the selected points colored yellow.</p>
<p>For example, in the graph below we have moved the selection box to the upper end of the Z dimension (high rent), and the low end of both X and Y (low percent children and low assistance). The selected observations are shown in yellow in the data cube.</p>
<div class="figure" style="text-align: center">
<img src="pics2/9_207_select3d.png" alt="3D Scatter Plot selection cube" width="80%" />
<p class="caption">
3D Scatter Plot selection cube
</p>
</div>
<p>The linking feature of GeoDa highlights these same five selected observations in the map.</p>
<div class="figure" style="text-align: center">
<img src="pics2/9_208_linkedtomap.png" alt="3D Scatter Plot selection linked to map" width="80%" />
<p class="caption">
3D Scatter Plot selection linked to map
</p>
</div>
<p>GeoDa also shows them in the bubble chart (from the previous section), confirming the association between low percentage kids, low assistance and high rent that we found earlier.</p>
<div class="figure" style="text-align: center">
<img src="pics2/9_210_selectbubble.png" alt="3D Scatter Plot selection linked to bubble chart" width="80%" />
<p class="caption">
3D Scatter Plot selection linked to bubble chart
</p>
</div>
<p>Similar to what we observed for the bubble chart, the 3D scatter plot is most useful for small to medium sized data sets. For larger numbers of observations, the point cloud quickly becomes overwhelming and no longer effective for visualization.</p>
</div>
</div>
<div id="multivariate-eda-parallel-coordinate-plot-and-conditional-plot" class="section level2 unnumbered">
<h2>Multivariate EDA: Parallel Coordinate Plot and Conditional Plot</h2>
<p>Once we move beyond three variables, it becomes difficult to visualize the actual multi-dimensional cloud plot for the observations. Instead, we resort to creative ways to reduce the dimension to something we can show in a standard two-dimensional view. Two methods that take a different approach to this problem are the parallel coordinate plot (PCP) and conditional plots.</p>
<div id="parallel-coordinate-plot-pcp" class="section level3 unnumbered">
<h3>Parallel Coordinate Plot (PCP)</h3>
<p>The parallel coordinate plot or PCP is designed to visually identify clusters and patterns in multi-dimensional variable space. Each variable is represented as a (parallel) axis, and each observation consists of a line that connects points on the axes. Clusters consist of groups of lines (i.e., observations) that follow a similar path. This is equivalent to points that are close together in multidimensional variable space. Unlike the latter, which can only be visualized for up to three dimensions (e.g., in the 3D scatter plot), the PCP can be applied to a large number of variables. The only limitation is human perception and screen real estate.</p>
<p>Outliers in a PCP are lines that show a very different pattern from the rest, similar to outlying points in a multi-dimensional cloud.</p>
<p>The PCP functionality is invoked from the menu as <strong>Explore &gt; Parallel Coordinate Plot</strong>, or by means of the PCP toolbar icon.</p>
<div class="figure" style="text-align: center">
<img src="pics2/10_212_pcpicon.png" alt="PCP toolbar icon" width="50%" />
<p class="caption">
PCP toolbar icon
</p>
</div>
<p>This brings up a variable selection dialog. Similar to the operation of the scatter plot matrix, we move variables from the left column to the right <strong>Include</strong> column using the arrows (or by double clicking on the variable name). In our example, we will use the same three variables as before, <strong>kids2000</strong>, <strong>rent2002</strong>, and <strong>pubast00</strong>, as well as a fourth, <strong>yrhom02</strong>, the average number of years lived in the current residence in 2002.</p>
<div class="figure" style="text-align: center">
<img src="pics2/10_213_pcpvariables.png" alt="PCP variable selection" width="60%" />
<p class="caption">
PCP variable selection
</p>
</div>
<p>Each line in the plot corresponds to one observation. The connected points are the values taken for that observation for each of the variables on the axes. The default PCP in GeoDa has the basic green colors, similar to the <strong>Themeless</strong> base map. The default is to show the descriptive statistics (mean, standard deviation) next to each of the axes (this can be changed with the <strong>Display</strong> option).</p>
<div class="figure" style="text-align: center">
<img src="pics2/10_215_defaultpcp.png" alt="Default PCP" width="80%" />
<p class="caption">
Default PCP
</p>
</div>
<p>The options for the PCP include all the standard ones we have seen before. As in the bubble chart, we also have the choice of <strong>Classification Themes</strong>. This allows for all of the themes used for choropleth maps to be applied to the top variable listed in the PCP. This makes it a little easier to compare the pattern of the observations for one variable to the relative order of those observations for other variables. We will keep the default (themeless) for now and revisit the classifications in the discussion of the <strong>Map</strong> functionality.</p>
<div class="figure" style="text-align: center">
<img src="pics2/10_216_pcp_options.png" alt="PCP options" width="40%" />
<p class="caption">
PCP options
</p>
</div>
<p>It often makes sense to change the order of the axes (variables) to bring out patterns of clustering (or outliers) more clearly. This is accomplished by dragging the circle associated with each axes to a different location. For example, here we drag the circle associated with <strong>pubast00</strong> up to move it to the second spot, above <strong>rent2002</strong>.</p>
<div class="figure" style="text-align: center">
<img src="pics2/10_217_pcp_moveaxis.png" alt="Moving the axes for PCP" width="80%" />
<p class="caption">
Moving the axes for PCP
</p>
</div>
<p>The resulting PCP shows more clearly how the low and high values for <strong>kids2000</strong> and <strong>pubast00</strong> align.</p>
<div class="figure" style="text-align: center">
<img src="pics2/10_220_pcpnewaxes.png" alt="PCP with axes moved" width="80%" />
<p class="caption">
PCP with axes moved
</p>
</div>
<p>Just like the scatter plot, the PCP can be <strong>brushed</strong>. We create a rectangular selection shape and select the five lowest values for <strong>kids2000</strong>. The pattern that results (only the selected observations, or lines, are highlighted in the graph) shows how these observations track very closely for the four variables considered here. This is a typical pattern for a <strong>visual cluster</strong> detected in the PCP. We can move the rectangle along the axes for <strong>kids2000</strong> to see how other clusters may occur. Alternatively, we can create the <em>brush</em> on any of the other axes and proceed in a similar way.</p>
<div class="figure" style="text-align: center">
<img src="pics2/10_218_pcpbrush.png" alt="Brushing the PCP" width="80%" />
<p class="caption">
Brushing the PCP
</p>
</div>
<p>The selection in the PCP is immediately linked to the other open views. For example, the five selected observations are sub-boroughs in Manhattan, as we have already seen before.</p>
<div class="figure" style="text-align: center">
<img src="pics2/10_219_pcponmap.png" alt="Linking PCP and map" width="80%" />
<p class="caption">
Linking PCP and map
</p>
</div>
<p>Similar to what holds for the other graphs, the brushing process can be initiated in any of the other open views, such as the map, histogram, box plot, scatter plot, bubble chart or 3D scatter plot.</p>
</div>
<div id="conditional-plots" class="section level3 unnumbered">
<h3>Conditional Plots</h3>
<p>Conditional plots, also known as Trellis graphs, provide a way to assess interactions between more than two variables. Multiple graphs or maps are constructed for different subsets of the observations, obtained as a result of <em>conditioning</em> on the value of two variables. GeoDa supports conditional maps, histograms and scatter plots.</p>
<p>Each of the three conditional plots is started from the <strong>Conditional Plot</strong> icon on the toolbar. This brings up a list giving three types of plots. Alternatively, the same can be accomplished from the menu, by means of <strong>Explore &gt; Conditional Plot</strong>, followed by the choice of <strong>Map</strong>, <strong>Histogram</strong> or <strong>Scatter Plot</strong> (note that the conditional map functionality can also be started from the map menu, as <strong>Map &gt; Conditional Map</strong>). In this exercise, we will focus on the conditional scatter plot, which allows four variables to be considered simultaneously.</p>
<div class="figure" style="text-align: center">
<img src="pics2/11_223_condploticon.png" alt="Conditional Plot toolbar icon" width="50%" />
<p class="caption">
Conditional Plot toolbar icon
</p>
</div>
<div class="figure" style="text-align: center">
<img src="pics2/11_224_condscatploticon.png" alt="Conditional Scatter Plot toolbar icon" width="15%" />
<p class="caption">
Conditional Scatter Plot toolbar icon
</p>
</div>
<p>The four variables required are selected in the variables selection dialog. Not only are there the conditioning variables for the x and y axes that need to be chosen, but also the two variables for the scatter plot itself. In our example, we have taken <strong>hhsiz00</strong> (median household size in 2000), <strong>yrhom02</strong> (average number of years lived in current residence, for 2002) as the two conditioning variables. The scatter plot is constructed with <strong>kids2000</strong> (% households with kids under 18 in 2000) on the x-axis and <strong>pubast00</strong> (% households receiving public assistance in 2000) on the y-axis.</p>
<div class="figure" style="text-align: center">
<img src="pics2/11_225_condscatplotvars.png" alt="Conditional Scatter Plot variable selection" width="60%" />
<p class="caption">
Conditional Scatter Plot variable selection
</p>
</div>
<p>The default plot consists of a 3 x 3 arrangement. In our example, the subsetting is too fine grained for 55 observations, since several cells have only minimal observations (e.g., 2, 3 and 4).</p>
<div class="figure" style="text-align: center">
<img src="pics2/11_226_condscat3x3.png" alt="3x3 Conditional Scatter Plot" width="80%" />
<p class="caption">
3x3 Conditional Scatter Plot
</p>
</div>
<p>The options menu provides a way to change the number of categories as well as the break points. The <strong>Vertical Bins Breaks</strong> and <strong>Horizontal Bins Breaks</strong> contain all the standard interval conventions (more about this when we discuss mapping), as well as the possibility to create custom cut-off points. In our example, we switch from a 3x3 setup to a 2x2 arrangement by selecting the median (<strong>Quantile &gt; 2</strong>) as the break point for each of the conditioning variables.<a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a></p>
<div class="figure" style="text-align: center">
<img src="pics2/11_227_binbreaks.png" alt="Adjusting bin breaks" width="40%" />
<p class="caption">
Adjusting bin breaks
</p>
</div>
<p>By default, a linear fit is shown through the scatter plots (<strong>Show Linear Smoother</strong>) and both the break points (<strong>View &gt; Display Axes Scale Values</strong>) and the slope value (<strong>View &gt; Display Slope Value</strong>) are displayed. The latter are highlighted as significant by means of one (p &lt; 0.05) or two asterisks (p &lt; 0.01).</p>
<div class="figure" style="text-align: center">
<img src="pics2/11_228_condscat2x2.png" alt="2x2 Conditional Scatter Plot" width="80%" />
<p class="caption">
2x2 Conditional Scatter Plot
</p>
</div>
<p>The resulting graph suggests a positive and significant slope between the number of kids and the degree of public assistance for those neighborhoods with more residential transition (smaller number of years lived in residence), as shown in the two graphs at the bottom. The slope is almost four times steeper in neighborhoods with larger household size (lower right graph). However, the relationship is not significant for the more residentially stable neighborhoods (number of years lived in residence above the median), irrespective of the household size (top two graphs).</p>
<p>Finally, the options also allow for a LOWESS smoother to be applied to the scatter plot points (<strong>Show LOWESS Smoother</strong>). For example, with the bandwidth set to 0.40 (through adjusting the bandwith with <strong>Edit LOWESS Parameters</strong>), this results in the following graph. We see again a more or less linear relationship in the bottom two scatter plots, but much more erratic behavior in the top ones. This confirms the lack of significance we found for the linear fit.</p>
<div class="figure" style="text-align: center">
<img src="pics2/11_229_condscatlowess.png" alt="LOWESS smooth of the Conditional Scatter Plot" width="80%" />
<p class="caption">
LOWESS smooth of the Conditional Scatter Plot
</p>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>University of Chicago, Center for Spatial Data Science – <a href="mailto:anselin@uchicago.edu">anselin@uchicago.edu</a><a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>In the <strong>GeoDa Preference Setup</strong>, under <strong>System</strong>, the transparency of the unhighlighted objects in a selection operation can be adjusted. The default is 0.80, which means only about 20% of the regular color is shown.<a href="#fnref2">↩</a></p></li>
<li id="fn3"><p>Note that the break point convention can be different for the horizontal and vertical axes, such as, 3 categories vertically and 2 horizontally.<a href="#fnref3">↩</a></p></li>
</ol>
</div>

<footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/lixun910/geoda">GeoDa</a> is maintained by <a href="#">lixun910</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

      </section>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-72724100-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
